! =============================================================================
! C8000V Bootstrap Configuration
! =============================================================================
! Device: {{ hostname }}
! Management IP: {{ mgmt_ip }}
!
! This is the BASE configuration required before IBN Platform can manage
! the device. Apply this via console or cloud-init.
!
! Prerequisites:
!   - EVE-NG connectivity
!   - Console access OR cloud-init setup
! =============================================================================

! === BASIC SETTINGS ===
hostname {{ hostname }}
!
ip domain-name ibn.lab
!

! === MANAGEMENT INTERFACE ===
! Connected to EVE-NG pnet1 (10.255.255.0/24)
interface {{ mgmt_interface | default('GigabitEthernet3') }}
 description Management - IBN Platform Access (pnet1)
 ip address {{ mgmt_ip }} {{ mgmt_mask | default('255.255.255.0') }}
 no shutdown
!

! === LOOPBACK ===
interface Loopback0
 description Router-ID and BGP Source
 ip address {{ loopback_ip }} 255.255.255.255
 no shutdown
!

! === AUTHENTICATION ===
! Create a local user for IBN Platform access
username {{ username | default('admin') }} privilege 15 secret {{ password }}
!
enable secret {{ enable_secret }}
!

! === AAA ===
aaa new-model
aaa authentication login default local
aaa authorization exec default local
!

! === SSH ===
crypto key generate rsa modulus 2048
!
ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 3
!
line vty 0 4
 login local
 transport input ssh
 exec-timeout 30 0
!

! === NETCONF (Recommended for IBN Platform) ===
netconf-yang
!
! Enable NETCONF features
netconf-yang feature candidate-datastore
!
! RESTCONF (optional, for API access)
restconf
!

! === SCP ===
ip scp server enable
!

! === LOGGING ===
logging buffered 51200 informational
logging console informational
!
! Timestamps for logs
service timestamps debug datetime msec localtime show-timezone
service timestamps log datetime msec localtime show-timezone
!

! === DNS (Optional) ===
ip name-server {{ dns_server | default('8.8.8.8') }}
!

! === DEFAULT ROUTE (for management) ===
ip route 0.0.0.0 0.0.0.0 {{ default_gateway | default('10.255.254.1') }}
!

! === ARCHIVE (for config rollback) ===
archive
 path flash:archive
 maximum 5
 time-period 1440
!

! =============================================================================
! END BOOTSTRAP CONFIGURATION
! =============================================================================
!
! EVE-NG Setup:
!   1. Connect {{ mgmt_interface | default('GigabitEthernet3') }} to pnet1 (Management Cloud)
!   2. Connect GigabitEthernet1/2 to other lab devices per topology
!
! After applying this config:
!   1. Verify SSH access: ssh admin@{{ mgmt_ip }}
!   2. Verify NETCONF: ssh -p 830 admin@{{ mgmt_ip }} -s netconf
!   3. Test from Mac: ping {{ mgmt_ip }} (requires route to 10.255.255.0/24)
!
! =============================================================================
